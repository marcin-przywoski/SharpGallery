<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SharpGallery.ViewModels"
             mc:Ignorable="d" d:DesignWidth="400" d:DesignHeight="200"
             x:Class="SharpGallery.Views.UpdateView"
             x:DataType="vm:UpdateViewModel">

    <Design.DataContext>
        <vm:UpdateViewModel/>
    </Design.DataContext>

    <Border Background="{DynamicResource SystemControlBackgroundChromeMediumBrush}"
            CornerRadius="8"
            Padding="16"
            Margin="8">
        <StackPanel Spacing="12">
            <!-- Header -->
            <StackPanel Orientation="Horizontal" Spacing="8">
                <PathIcon Data="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"
                          Width="20" Height="20"
                          Foreground="{DynamicResource SystemAccentColor}"/>
                <TextBlock Text="Software Update"
                           FontWeight="SemiBold"
                           FontSize="16"
                           VerticalAlignment="Center"/>
            </StackPanel>

            <!-- Status Message -->
            <TextBlock Text="{Binding StatusMessage}"
                       TextWrapping="Wrap"
                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>

            <!-- Download Progress -->
            <ProgressBar Value="{Binding DownloadProgress}"
                         Maximum="100"
                         IsVisible="{Binding IsDownloading}"
                         Height="4"/>

            <!-- Action Buttons -->
            <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
                <!-- Check for Updates Button -->
                <Button Content="Check for Updates"
                        Command="{Binding CheckForUpdatesCommand}"
                        IsVisible="{Binding !IsUpdateAvailable}"
                        IsEnabled="{Binding !IsCheckingForUpdates}"/>

                <!-- Download Button -->
                <Button Content="Download Update"
                        Command="{Binding DownloadUpdateCommand}"
                        IsVisible="{Binding IsUpdateAvailable}"
                        IsEnabled="{Binding !IsDownloading}"
                        Classes="accent"/>

                <!-- Install Buttons -->
                <Button Content="Install &amp; Restart"
                        Command="{Binding InstallAndRestartCommand}"
                        IsVisible="{Binding IsReadyToInstall}"
                        Classes="accent"/>

                <Button Content="Install on Exit"
                        Command="{Binding InstallOnExitCommand}"
                        IsVisible="{Binding IsReadyToInstall}"/>
            </StackPanel>

            <!-- Loading Indicator -->
            <ProgressBar IsIndeterminate="True"
                         IsVisible="{Binding IsCheckingForUpdates}"
                         Height="2"/>
        </StackPanel>
    </Border>
</UserControl>
